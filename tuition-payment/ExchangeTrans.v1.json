{
  "swagger": "2.0",
  "info": {
    "title": "c.Currency ExChange API",
    "version": "1.0"
  },
  "host": "https://global-api.lianlianpay.com/service/payment/v1",
  "schemes": [
    "https"
  ],
  "produces": [
    "application/json"
  ],
  "consumes": [
    "application/json"
  ],
  "paths": {
    "/exchange": {
      "post": {
        "summary": "1.Create Currency Exchange Transcation",
        "operationId": "post-exchanges",
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "description": "汇兑分发申请接口，最终汇兑分发结果异步返回或调用方使用查询接口。\n\n汇兑指令提交必须满足以下条件\n\n1.相关贸易材料必须为审核通过状态\n\n2.汇兑金额不能超过账单金额或虚拟卡累计加款金额的百分之三的浮动\n\n3.账单不存在汇兑申请中或成功汇兑的交易\n\n如果境外收款银行账户不传则只做汇兑",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "schema": {
              "type": "object",
              "properties": {
                "exchangeId": {
                  "type": "string",
                  "description": "汇出指令编号"
                },
                "billId": {
                  "type": "string",
                  "description": "账单编号"
                },
                "pricingCurrency": {
                  "type": "string",
                  "description": "ISO 3166 Alpha-3，源币种或目的币\n种，当值为源币种时，根据\nsourceAmount 及汇率计算\ntargetAmount\n当值为目的币种时，根据\ntargetAmount 及汇率计算\nsourceAmount"
                },
                "sourceCurrency": {
                  "type": "string",
                  "description": "CNY"
                },
                "sourceAmount": {
                  "type": "string",
                  "description": " 当定价币种为源币种必传，单位元，必填。例：\n10.11"
                },
                "targetCurrency": {
                  "type": "string",
                  "description": "汇出的币种\n\n| currency | description  |\n|--------|-------------|\n|USD |美元|\n|EUR |欧元|\n|GBP |英镑|\n|CAD |加币|\n|JPY |日元|\n|THB |泰铢|\n|IDR |印尼盾|\n|AED |迪拉姆|\n|HKD |港币|\n|CNH |离岸人民币|\n\n"
                },
                "targetAmount": {
                  "type": "string",
                  "description": "汇出的金额，当定价币种为目的币种必\n填，单位元，例：10.11"
                },
                "payeeBankAccount": {
                  "$ref": "#/definitions/PayeeBankAccountInfo"
                },
                "rfb": {
                  "type": "string",
                  "description": "交易附言"
                },
                "tradeCode": {
                  "type": "string",
                  "description": "贸易编码"
                },
                "payeeLlpAccount": {
                  "$ref": "#/definitions/payeelliAccount"
                },
                "payeeAccountType": {
                  "type": "string",
                  "enum": [
                    "BANK_ACCOUNT",
                    "LL_ACCOUNT"
                  ]
                }
              },
              "required": [
                "exchangeId",
                "billId",
                "pricingCurrency",
                "sourceCurrency",
                "targetCurrency",
                "tradeCode"
              ]
            },
            "description": ""
          }
        ],
        "tags": [
          "Operations"
        ]
      },
      "get": {
        "summary": "2.Query Bill Exchange Transcation",
        "operationId": "get-exchanges",
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ExchangeTrans"
              }
            }
          }
        },
        "parameters": [
          {
            "type": "string",
            "in": "query",
            "name": "billId",
            "description": "账单编号"
          }
        ],
        "tags": [
          "Operations"
        ]
      },
      "parameters": []
    },
    "/exchange/{exchangeId}": {
      "parameters": [
        {
          "type": "string",
          "name": "exchangeId",
          "in": "path",
          "required": true
        }
      ],
      "get": {
        "summary": "3.Get Exchange Status",
        "tags": [
          "Operations"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/ExchangeTrans"
            }
          }
        },
        "operationId": "get-exchanges-exchangeid"
      }
    },
    "/exchangereturn": {
      "post": {
        "summary": "4.Return Exchange Trans",
        "operationId": "post-exchangereturns",
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "schema": {
              "type": "object",
              "properties": {
                "exchangeReturnId": {
                  "type": "string",
                  "description": "退汇指令id"
                },
                "exchangeId": {
                  "type": "string",
                  "description": "原汇出指令id"
                },
                "returnCurrency": {
                  "type": "string",
                  "description": "支持cny"
                },
                "returnAmount": {
                  "type": "string",
                  "description": "退汇金额"
                },
                "memo": {
                  "type": "string",
                  "description": "备注"
                }
              },
              "required": [
                "exchangeReturnId",
                "exchangeId",
                "returnCurrency",
                "returnAmount"
              ]
            }
          }
        ],
        "description": "部分退汇申请接口，最终退汇结果异步返回或调用方使用查询接口。\n\n1.退汇只支持FX指令\n\n2.退汇采用原汇兑交易汇率及信息进行退汇及反向申报处理。\n\n3.退汇总金额（原汇兑多次退汇情况）不能大于原汇兑交易的外币交易金额\n\n4.支持原交易源币种或目的币种进行退汇\n\n5.仅支持部分退汇,如发起后无法再次发起相同账单的汇兑指令，如需全部退汇请调用exchangecancel指令\n\n退汇只负责外币退回人民币，对于人民币退回到用户的银行账户，请使用退款接口。",
        "tags": [
          "Operations"
        ]
      },
      "parameters": []
    },
    "/exchangereturn/{exchangReturnId}": {
      "parameters": [
        {
          "type": "string",
          "name": "exchangReturnId",
          "in": "path",
          "required": true
        }
      ],
      "get": {
        "summary": "5.Get Exchange Return Status",
        "tags": [
          "Operations"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/ExchangeReturn"
            }
          }
        },
        "operationId": "get-exchangereturns-exchangReturnId"
      }
    },
    "/exchange/{exchangeId}/cancel": {
      "put": {
        "summary": "6.Cancel Exchange Trans",
        "operationId": "put-exchangecancel",
        "responses": {
          "200": {
            "description": "OK"
          },
          "201": {
            "schema": {
              "type": "object",
              "properties": {
                "": {
                  "type": "string"
                }
              }
            }
          }
        },
        "parameters": [],
        "description": "汇兑取消申请接口,最终取消结果异步返回或调用方使用查询接口。\n\n1.退汇只支持FX指令\n\n2.发起过部分退汇的指令不允许发起汇兑取消\n\n3.采用原汇兑交易汇率及信息进行退汇及反向申报处理。\n\n4.汇兑取消成功后可重新发起汇兑交易",
        "tags": [
          "Operations"
        ]
      },
      "parameters": [
        {
          "type": "string",
          "name": "exchangeId",
          "in": "path",
          "required": true
        }
      ]
    }
  },
  "definitions": {
    "ExchangeTrans": {
      "title": "1-ExchangeTrans",
      "type": "object",
      "description": "对于状态为reviewed，exchanged且账单无锁定汇率，商户可发送汇兑分发指令.\n注:相关接口及对象参照<连连跨境支付标准汇出接口文档 version 1.7>中 4.7 汇出指令申请 和 <连连跨境支付汇兑汇出接口文档v1.0>\n中3.1汇兑汇出.\n\n注意：如果相关指令中payeeBankAccount为空,则只做货币转换处理,如果指定银行帐号则进行目标币种的分发处理.\n\n",
      "x-tags": [
        "Models"
      ],
      "x-examples": {},
      "properties": {
        "exchangeId": {
          "type": "string",
          "description": "汇兑交易ID，商户全局唯一"
        },
        "billId": {
          "type": "string",
          "description": "对应账单的汇兑处理，一般情况下，未自动汇兑的账单可进行一次汇兑处理（分发）。"
        },
        "pricingCurrency": {
          "type": "string",
          "description": "定价币种:\nISO 3166 Alpha-3，源币种或目的币\n种，当值为源币种时，根据\nsourceAmount 及汇率计算\ntargetAmount\n当值为目的币种时，根据\ntargetAmount 及汇率计算\nsourceAmount"
        },
        "sourceCurrency": {
          "type": "string",
          "description": "源币种:一般为CNY"
        },
        "sourceAmount": {
          "type": "string",
          "description": "源币种金额:当定价币种为源币种必传，必填。例：10.11"
        },
        "targetCurrency": {
          "type": "string",
          "description": "目的币种:汇出的币种"
        },
        "targetAmount": {
          "description": "目的(汇出)金额:汇出的金额，当定价币种为目的币种必填，例：10.11。",
          "type": "string"
        },
        "payeeBankAccount": {
          "$ref": "#/definitions/PayeeBankAccountInfo"
        },
        "rfb": {
          "type": "string",
          "description": "如果payeeBankAccount不为空,则可填写收款人附言"
        },
        "tradeCode": {
          "type": "string",
          "description": "贸易编码\n\n|tradeCode|description|\n|---------|-----------|\n|xxxx1|留学费用|\n|xxxx2|留学手续费|"
        },
        "status": {
          "type": "string",
          "description": "汇兑分发指令处理状态\n\n| status | description |\n|--------|-------------|\n|INIT|指令受理成功|\n|PROCESSING|处理中|\n|SUCCESS|处理成功|\n|FAILED|处理失败|\n|PAYMENT_REVERSED_AFTER_SUCCESS|银行退汇处理成功|\n|CANCEL|取消成功|\n",
          "enum": [
            "PAYMENT_SUCCESS",
            "PAYMENT_REVERSED_AFTER_SUCCESS",
            "EXCHANGE_SUCCESS",
            "PROCESSING",
            "FAILED",
            "INIT",
            "EXCHANGE_CANCEL",
            "EXCHANGE_CANCELING"
          ]
        },
        "cancelStatus": {
          "type": "string",
          "description": "| cancelStatus | description |\n|--------|-------------|\n|INIT|初始化|\n|PROCESSING|处理中|\n|SUCCESS|取消成功|\n|FAILED |处理失败|\n",
          "enum": [
            "PROCESSING",
            "SUCCESS",
            "FAILED"
          ]
        },
        "failReason": {
          "type": "string",
          "description": "失败原因 "
        },
        "rate": {
          "type": "string",
          "description": "汇兑汇率"
        },
        "createTime": {
          "type": "string",
          "description": "创建时间"
        }
      },
      "required": [
        "exchangeId",
        "billId",
        "pricingCurrency",
        "sourceCurrency",
        "targetCurrency",
        "tradeCode"
      ]
    },
    "PayeeBankAccountInfo": {
      "title": "2-PayeeBankAccountInfo",
      "type": "object",
      "description": "境外收款人银行帐户信息",
      "x-tags": [
        "Models"
      ],
      "properties": {
        "payeeCountryCode": {
          "type": "string",
          "description": "收款人国家或地区编码:\nISO 3166 Alpha-3，如 USA。"
        },
        "payeeName": {
          "type": "string",
          "description": "收款人姓名"
        },
        "payeeAddress": {
          "type": "string",
          "description": "收款人地址"
        },
        "payeeBankDistrict": {
          "type": "string",
          "description": "收款人开户银行所在国家或地区编码:\nISO 3166 Alpha-3，如 US."
        },
        "payeeBankAccountType": {
          "type": "string",
          "description": "|payeeBankAccountType| description |\n|--------|-------------|\n|INDIVIDUAL|个人|\n|CORPORATE|企业|\n收款人银行账号类型.\n",
          "enum": [
            "INDIVIDUAL",
            "CORPORATE"
          ]
        },
        "payeeBankName": {
          "type": "string",
          "description": "收款人银行名称"
        },
        "payeeBankType": {
          "type": "string",
          "description": "|payeeBankType| description |\n|--------|-------------|\n|IBAN|欧洲地区国际银行账号|\n|SORT|英国地区银行账户|\n收款银行国际编码类型"
        },
        "payeeBankCode": {
          "type": "string",
          "description": "收款银行国际编码:\n如已填写 payeeBankType，此处填写\n对应 IBAN 值或 Sortcode 值"
        },
        "payeeAccount": {
          "type": "string",
          "description": "收款人银行账号"
        },
        "payeeBankAddress": {
          "type": "string",
          "description": "收款人银行地址"
        },
        "payeeBankSwiftCode": {
          "type": "string",
          "description": "收款银行\nSwiftCode"
        }
      },
      "required": [
        "payeeCountryCode",
        "payeeName",
        "payeeBankName",
        "payeeBankCode",
        "payeeAccount",
        "payeeBankAddress",
        "payeeBankSwiftCode"
      ]
    },
    "ExchangeReturn": {
      "title": "3-ExchangeReturn",
      "type": "object",
      "description": "",
      "x-tags": [
        "Models"
      ],
      "properties": {
        "exchangeReturnId": {
          "type": "string",
          "description": "退汇指令编号，全局唯一"
        },
        "exchangeId": {
          "type": "string",
          "description": "原汇兑指令编号"
        },
        "returnCurrency": {
          "type": "string",
          "description": "原汇兑的目标币种"
        },
        "returnAmount": {
          "type": "string",
          "description": "退汇的外汇金额"
        },
        "createTime": {
          "type": "string",
          "description": "创建时间"
        },
        "status": {
          "type": "string",
          "description": "退汇交易状态\n\n|status|description|\n|------|------------|\n|INIT|退汇申请成功|\n|PROCESSING|退汇中|\n|SUCCESS|退汇成功|\n|FAILED|退汇失败失败|"
        },
        "failReason": {
          "type": "string",
          "description": "失败原因"
        },
        "memo": {
          "type": "string",
          "description": "退汇原因"
        }
      },
      "required": [
        "exchangeReturnId",
        "exchangeId",
        "returnCurrency",
        "returnAmount"
      ]
    },
    "payeelliAccount": {
      "title": "PayeeLlpAccount",
      "type": "object",
      "properties": {
        "payeeAccount": {
          "type": "string"
        }
      }
    }
  }
}